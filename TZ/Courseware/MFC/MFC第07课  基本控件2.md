***
[TOC]
***

# `1. 列表控件`

列表控件是一个很有特色的控件, 提供了四种形态:

1. LVS_SMALLICON   	小图标
2. LVS_ICON                图标
3. LVS_LIST                列表
4. LVS_REPORT              报表

主要的消息&函数有:

Create()

SetExtentStyle()

InsertColumn()

InsertItem()

SetItemText()

GetItemCount()



GetSelectionMark()

## `1.1 小图标列表`

## `1.2 图标列表`

## `1.3 列表`

## `1.4 报表`

```
CRect rt;
GetClientRect(&rt);

CListCtrl* pLC = new CListCtrl;
pLC->Create(LVS_REPORT | WS_BORDER | WS_CHILD, rt, this, 1000);
pLC->SetExtendedStyle(pLC->GetExtendedStyle() | LVS_EX_FULLROWSELECT | LVS_EX_GRIDLINES | LVS_EX_HEADERDRAGDROP);
pLC->SetBkColor(RGB(0xdd, 0xdd, 0xdd));
pLC->InsertColumn(0, L"Clm0", LVCFMT_CENTER, rt.Width() / 4);
pLC->InsertColumn(1, L"Clm1", LVCFMT_CENTER, rt.Width() / 4 - 2);
pLC->InsertColumn(2, L"Clm2", LVCFMT_CENTER, rt.Width() / 4 - 2);
pLC->InsertColumn(3, L"Clm3", LVCFMT_CENTER, rt.Width() / 4 - 2);

CString tmp{};
for (int i = 0; i < 100; i++)
{
	pLC->InsertItem(i, L"");

	for (int j = 0; j < 4; j++)
	{
		tmp.Format(L"%d, %d", i, j);
		pLC->SetItemText(i, j, tmp.GetBuffer());
	}
}

pLC->ShowWindow(SW_SHOW);
pLC->UpdateWindow();
```
```
void CMyLV::OnNMClick(NMHDR *pNMHDR, LRESULT *pResult)
{
	LPNMITEMACTIVATE pNMItemActivate = reinterpret_cast<LPNMITEMACTIVATE>(pNMHDR);

	// TODO: Add your control notification handler code here
	DWORD dwPos = GetMessagePos();
	CPoint point(LOWORD(dwPos), HIWORD(dwPos));
	ScreenToClient(&point);
	LVHITTESTINFO lvinfo;
	lvinfo.pt = point;
	lvinfo.flags = LVHT_ABOVE;
	int iItem = SubItemHitTest(&lvinfo);
	if (iItem != -1)
	{
		CString strTmp;
		strTmp.Format(L"单击的是第%d行第%d列", lvinfo.iItem, lvinfo.iSubItem);
		AfxMessageBox(strTmp);
	}

	*pResult = 0;
}
```

# `2. 微调框`
```
void CMFCApplication12Dlg::OnDeltapos0(NMHDR *pNMHDR, LRESULT *pResult)
{
	LPNMUPDOWN pNMUpDown = reinterpret_cast<LPNMUPDOWN>(pNMHDR);

	// TODO: Add your control notification handler code here
	CWnd* pWnd = (CWnd*)GetDlgItem(IDEDT_0); //得到指向编辑框的窗口指针
	CString strValue;
	pWnd->GetWindowText(strValue); //得到编辑框中的内容
	if (!strValue.IsEmpty())
	{
		int iValue{};
		char str[256]{};
		WideCharToMultiByte(CP_ACP, 0, strValue.GetBuffer(), -1, str, 256, 0, 0);
		iValue = ::atoi(str);

		if (1 == pNMUpDown->iDelta)//如果点击的是Spin中的往上按钮
			iValue++;
		else if (-1 == pNMUpDown->iDelta) //如果点击的是Spin中往下按钮
			iValue--;

		::_itoa_s(iValue, str, 10);
		strValue = str;
		pWnd->SetWindowTextW(strValue);
	}

	*pResult = 0;
}
```

# `3. 进度条`

```
void CMFCApplication12Dlg::OnDeltapos0(NMHDR *pNMHDR, LRESULT *pResult)
{
	LPNMUPDOWN pNMUpDown = reinterpret_cast<LPNMUPDOWN>(pNMHDR);

	// TODO: Add your control notification handler code here

	if (1 == pNMUpDown->iDelta)//如果点击的是Spin中的往上按钮
		m_pc0.SetPos(m_pc0.GetPos() + m_pc0.GetStep());
	else if (-1 == pNMUpDown->iDelta) //如果点击的是Spin中往下按钮
		m_pc0.SetPos(m_pc0.GetPos() - m_pc0.GetStep());

	*pResult = 0;
}
```

# `4. 滑动条`

```
void CMFCApplication12Dlg::OnNMCustomdraw0(NMHDR *pNMHDR, LRESULT *pResult)
{
	LPNMCUSTOMDRAW pNMCD = reinterpret_cast<LPNMCUSTOMDRAW>(pNMHDR);
	// TODO: Add your control notification handler code here
	int iPos = m_sc0.GetPos();
	CStringW wcsTmp;
	wcsTmp.Format(L"%d", iPos);
	m_edt.SetWindowTextW(wcsTmp);

	*pResult = 0;
}
```

